extends ../layout.pug
block content 
    div(class='tabBox')
    form
        div(class="form-group")
            label(for="cateName") 分类名称
            input(class="form-control" id="cateName" name='cateName' type="text" placeholder="请输入分类名称")
        div(class="form-group")
            label(for="cateShort") 保存名称(默认拼音)
            input(class="form-control" id="cateShort" name='cateShort' type="text" placeholder="保存名称(默认拼音)")
        button(class="btn btn-primary" id='categoryAdd' type="button") 保存
    script(src="/static/js/common.js")
    script.
        let cateName = $("#cateName"),
            cateShort = $("#cateShort");

        $("#categoryAdd").on("click",()=>{
            if(cateName.val() == ''){
                cateName.after(hintErr('名称不能为空', cateName))
                return
            }
            $.ajax({
                type:'post',
                url:"/category/category_add",
                data:{
                   cateName:cateName.val(),
                   cateShort:cateShort.val() 
                },
                dataType:'json',
                success(data){
                    if(data.code == 1 || data.code == 2){
                       cateName.after(hintErr(data.message, cateName))
                        return
                    }
                    $("#categoryAdd").before(alertBox(data.message+'2秒后跳转'))
                    setTimeout(()=>{
                         window.location.href="/category"
                    },2000)
                }
            })
        })